<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Mail::Body - mail-2.6.1 Documentation</title>

<link href="../fonts.css" rel="stylesheet">
<link href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/navigation.js"></script>
<script src="../js/search_index.js"></script>
<script src="../js/search.js"></script>
<script src="../js/searcher.js"></script>
<script src="../js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-3C-3C">#&lt;&lt;</a>
    
    <li class="calls-super" ><a href="#method-i-3D-3D">#==</a>
    
    <li ><a href="#method-i-3D-7E">#=~</a>
    
    <li ><a href="#method-i-boundary">#boundary</a>
    
    <li ><a href="#method-i-boundary-3D">#boundary=</a>
    
    <li ><a href="#method-i-charset">#charset</a>
    
    <li ><a href="#method-i-charset-3D">#charset=</a>
    
    <li ><a href="#method-i-crlf_boundary">#crlf_boundary</a>
    
    <li ><a href="#method-i-decoded">#decoded</a>
    
    <li ><a href="#method-i-empty-3F">#empty?</a>
    
    <li ><a href="#method-i-encoded">#encoded</a>
    
    <li ><a href="#method-i-encoding">#encoding</a>
    
    <li ><a href="#method-i-encoding-3D">#encoding=</a>
    
    <li ><a href="#method-i-end_boundary">#end_boundary</a>
    
    <li ><a href="#method-i-epilogue">#epilogue</a>
    
    <li ><a href="#method-i-epilogue-3D">#epilogue=</a>
    
    <li ><a href="#method-i-get_best_encoding">#get_best_encoding</a>
    
    <li ><a href="#method-i-include-3F">#include?</a>
    
    <li ><a href="#method-i-match">#match</a>
    
    <li ><a href="#method-i-multipart-3F">#multipart?</a>
    
    <li ><a href="#method-i-only_us_ascii-3F">#only_us_ascii?</a>
    
    <li ><a href="#method-i-parts">#parts</a>
    
    <li ><a href="#method-i-preamble">#preamble</a>
    
    <li ><a href="#method-i-preamble-3D">#preamble=</a>
    
    <li ><a href="#method-i-raw_source">#raw_source</a>
    
    <li ><a href="#method-i-set_charset">#set_charset</a>
    
    <li ><a href="#method-i-set_sort_order">#set_sort_order</a>
    
    <li ><a href="#method-i-sort_parts-21">#sort_parts!</a>
    
    <li ><a href="#method-i-split-21">#split!</a>
    
    <li ><a href="#method-i-to_s">#to_s</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Mail::Body">
  <h1 id="class-Mail::Body" class="class">
    class Mail::Body
  </h1>

  <section class="description">
    
<h1 id="class-Mail::Body-label-Body"><a href="Body.html">Body</a><span><a href="#class-Mail::Body-label-Body">&para;</a> <a href="#documentation">&uarr;</a></span></h1>

<p>The body is where the text of the email is stored.  <a
href="../Mail.html">Mail</a> treats the body as a single object.  The body
itself has no information about boundaries used in the MIME standard, it
just looks at its content as either a single block of text, or (if it is a
multipart message) as an array of blocks of text.</p>

<p>A body has to be told to split itself up into a multipart message by
calling split with the correct boundary.  This is because the body object
has no way of knowing what the correct boundary is for itself (there could
be many boundaries in a body in the case of a nested MIME text).</p>

<p>Once split is called, <a href="Body.html">Mail::Body</a> will slice itself
up on this boundary, assigning anything that appears before the first part
to the preamble, and anything that appears after the closing boundary to
the epilogue, then each part gets initialized into a <a
href="Part.html">Mail::Part</a> object.</p>

<p>The boundary that is used to split up the <a href="Body.html">Body</a> is
also stored in the <a href="Body.html">Body</a> object for use on encoding
itself back out to a string.  You can  overwrite this if it needs to be
changed.</p>

<p>On encoding, the body will return the preamble, then each part joined by
the boundary, followed by a closing boundary string and then the epilogue.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(string = '')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 28</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">string</span> = <span class="ruby-string">''</span>)
  <span class="ruby-ivar">@boundary</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@preamble</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@epilogue</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@charset</span>  = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@part_sort_order</span> = [ <span class="ruby-string">&quot;text/plain&quot;</span>, <span class="ruby-string">&quot;text/enriched&quot;</span>, <span class="ruby-string">&quot;text/html&quot;</span> ]
  <span class="ruby-ivar">@parts</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">PartsList</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">blank?</span>
    <span class="ruby-ivar">@raw_source</span> = <span class="ruby-string">''</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Do join first incase we have been given an Array in Ruby 1.9</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:join</span>)
      <span class="ruby-ivar">@raw_source</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">''</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_s</span>)
      <span class="ruby-ivar">@raw_source</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;You can only assign a string or an object that responds_to? :join or :to_s to a body.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@encoding</span> = (<span class="ruby-identifier">only_us_ascii?</span> <span class="ruby-operator">?</span> <span class="ruby-string">'7bit'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'8bit'</span>)
  <span class="ruby-identifier">set_charset</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-3C-3C" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&lt;&lt;</span><span
            class="method-args">( val )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="3C-3C-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;&lt;</span>( <span class="ruby-identifier">val</span> )
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@parts</span>
    <span class="ruby-ivar">@parts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">val</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@parts</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">PartsList</span>.<span class="ruby-identifier">new</span>[<span class="ruby-identifier">val</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">==</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Matches this body with another body.  Also matches the decoded value of
this body with a string.</p>

<p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'The body'</span>)
<span class="ruby-identifier">body</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">body</span> <span class="ruby-comment">#=&gt; true</span>

<span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'The body'</span>)
<span class="ruby-identifier">body</span> <span class="ruby-operator">==</span> <span class="ruby-string">'The body'</span> <span class="ruby-comment">#=&gt; true</span>

<span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;VGhlIGJvZHk=\n&quot;</span>)
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-string">'base64'</span>
<span class="ruby-identifier">body</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;The body&quot;</span> <span class="ruby-comment">#=&gt; true</span>
</pre>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="3D-3D-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">decoded</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">super</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3D-7E" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">=~</span><span
            class="method-args">(regexp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Accepts a string and performs a regular expression against the decoded text</p>

<p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'The body'</span>)
<span class="ruby-identifier">body</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/The/</span> <span class="ruby-comment">#=&gt; 0</span>

<span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;VGhlIGJvZHk=\n&quot;</span>)
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-string">'base64'</span>
<span class="ruby-identifier">body</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/The/</span> <span class="ruby-comment">#=&gt; 0</span>
</pre>
          
          

          
          <div class="method-source-code" id="3D-7E-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 83</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">=~</span>(<span class="ruby-identifier">regexp</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">decoded</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">regexp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-boundary" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">boundary</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the boundary used by the body</p>
          
          

          
          <div class="method-source-code" id="boundary-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 236</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">boundary</span>
  <span class="ruby-ivar">@boundary</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-boundary-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">boundary=</span><span
            class="method-args">( val )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Allows you to change the boundary of this <a href="Body.html">Body</a>
object</p>
          
          

          
          <div class="method-source-code" id="boundary-3D-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 241</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">boundary=</span>( <span class="ruby-identifier">val</span> )
  <span class="ruby-ivar">@boundary</span> = <span class="ruby-identifier">val</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-charset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">charset</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="charset-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">charset</span>
  <span class="ruby-ivar">@charset</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-charset-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">charset=</span><span
            class="method-args">( val )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="charset-3D-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">charset=</span>( <span class="ruby-identifier">val</span> )
  <span class="ruby-ivar">@charset</span> = <span class="ruby-identifier">val</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decoded" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decoded</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="decoded-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 174</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decoded</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Encodings</span>.<span class="ruby-identifier">defined?</span>(<span class="ruby-identifier">encoding</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">UnknownEncodingType</span>, <span class="ruby-node">&quot;Don't know how to decode #{encoding}, please call #encoded and decode it yourself.&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Encodings</span>.<span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">encoding</span>).<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">raw_source</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-empty-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">empty?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="empty-3F-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 272</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty?</span>
  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">raw_source</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-encoded" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">encoded</span><span
            class="method-args">(transfer_encoding = '8bit')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a body encoded using transfer_encoding.  Multipart always uses an
identiy encoding (i.e. no encoding). Calling this directly is not a good
idea, but supported for compatibility TODO: Validate that preamble and
epilogue are valid for requested encoding</p>
          
          

          
          <div class="method-source-code" id="encoded-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 149</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">encoded</span>(<span class="ruby-identifier">transfer_encoding</span> = <span class="ruby-string">'8bit'</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">multipart?</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">sort_parts!</span>
    <span class="ruby-identifier">encoded_parts</span> = <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">encoded</span> }
    ([<span class="ruby-identifier">preamble</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">encoded_parts</span>).<span class="ruby-identifier">join</span>(<span class="ruby-identifier">crlf_boundary</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">end_boundary</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">epilogue</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">be</span> = <span class="ruby-identifier">get_best_encoding</span>(<span class="ruby-identifier">transfer_encoding</span>)
    <span class="ruby-identifier">dec</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Encodings</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">encoding</span>)
    <span class="ruby-identifier">enc</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Encodings</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">be</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">transfer_encoding</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">encoding</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">dec</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-comment"># Cannot decode, so skip normalization</span>
        <span class="ruby-identifier">raw_source</span>
    <span class="ruby-keyword">else</span>
        <span class="ruby-comment"># Decode then encode to normalize and allow transforming </span>
        <span class="ruby-comment"># from base64 to Q-P and vice versa</span>
        <span class="ruby-identifier">decoded</span> = <span class="ruby-identifier">dec</span>.<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">raw_source</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">charset</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">charset</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;US-ASCII&quot;</span>
          <span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">encode!</span>(<span class="ruby-identifier">charset</span>)
          <span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">'BINARY'</span>) <span class="ruby-keyword">unless</span> <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">charset</span>).<span class="ruby-identifier">ascii_compatible?</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">enc</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">decoded</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-encoding" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">encoding</span><span
            class="method-args">(val = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="encoding-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 194</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">encoding</span>(<span class="ruby-identifier">val</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">val</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">val</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-encoding-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">encoding=</span><span
            class="method-args">( val )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="encoding-3D-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 202</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">encoding=</span>( <span class="ruby-identifier">val</span> )
  <span class="ruby-ivar">@encoding</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;text&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">blank?</span>
      (<span class="ruby-identifier">only_us_ascii?</span> <span class="ruby-operator">?</span> <span class="ruby-string">'7bit'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'8bit'</span>)
  <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">val</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-epilogue" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">epilogue</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the epilogue (any text that is after the last MIME boundary)</p>
          
          

          
          <div class="method-source-code" id="epilogue-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 221</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">epilogue</span>
  <span class="ruby-ivar">@epilogue</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-epilogue-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">epilogue=</span><span
            class="method-args">( val )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets the epilogue to a string (adds text after the last MIME boundary)</p>
          
          

          
          <div class="method-source-code" id="epilogue-3D-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 226</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">epilogue=</span>( <span class="ruby-identifier">val</span> )
  <span class="ruby-ivar">@epilogue</span> = <span class="ruby-identifier">val</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_best_encoding" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_best_encoding</span><span
            class="method-args">(target)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_best_encoding-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 140</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_best_encoding</span>(<span class="ruby-identifier">target</span>)
  <span class="ruby-identifier">target_encoding</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Encodings</span>.<span class="ruby-identifier">get_encoding</span>(<span class="ruby-identifier">target</span>)
  <span class="ruby-identifier">target_encoding</span>.<span class="ruby-identifier">get_best_compatible</span>(<span class="ruby-identifier">encoding</span>, <span class="ruby-identifier">raw_source</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-include-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">include?</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Accepts anything that responds to <a
href="Body.html#method-i-to_s">to_s</a> and checks if it’s a substring of
the decoded text</p>

<p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'The body'</span>)
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'The'</span>) <span class="ruby-comment">#=&gt; true</span>

<span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;VGhlIGJvZHk=\n&quot;</span>)
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-string">'base64'</span>
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'The'</span>) <span class="ruby-comment">#=&gt; true</span>
</pre>
          
          

          
          <div class="method-source-code" id="include-3F-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 111</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">include?</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-match" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">match</span><span
            class="method-args">(regexp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Accepts a string and performs a regular expression against the decoded text</p>

<p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'The body'</span>)
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/The/</span>) <span class="ruby-comment">#=&gt; #&lt;MatchData &quot;The&quot;&gt;</span>

<span class="ruby-identifier">body</span> = <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Body</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;VGhlIGJvZHk=\n&quot;</span>)
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-string">'base64'</span>
<span class="ruby-identifier">body</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/The/</span>) <span class="ruby-comment">#=&gt; #&lt;MatchData &quot;The&quot;&gt;</span>
</pre>
          
          

          
          <div class="method-source-code" id="match-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">regexp</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">decoded</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">regexp</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-multipart-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">multipart?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are parts defined in the body</p>
          
          

          
          <div class="method-source-code" id="multipart-3F-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">multipart?</span>
  <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-only_us_ascii-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">only_us_ascii?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="only_us_ascii-3F-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 268</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">only_us_ascii?</span>
  <span class="ruby-operator">!</span>(<span class="ruby-identifier">raw_source</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[^\x01-\x7f]/</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parts" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parts</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parts-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parts</span>
  <span class="ruby-ivar">@parts</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-preamble" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">preamble</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the preamble (any text that is before the first MIME boundary)</p>
          
          

          
          <div class="method-source-code" id="preamble-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 211</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">preamble</span>
  <span class="ruby-ivar">@preamble</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-preamble-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">preamble=</span><span
            class="method-args">( val )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets the preamble to a string (adds text before the first MIME boundary)</p>
          
          

          
          <div class="method-source-code" id="preamble-3D-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 216</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">preamble=</span>( <span class="ruby-identifier">val</span> )
  <span class="ruby-ivar">@preamble</span> = <span class="ruby-identifier">val</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-raw_source" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">raw_source</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the raw source that the body was initialized with, without any
tampering</p>
          
          

          
          <div class="method-source-code" id="raw_source-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">raw_source</span>
  <span class="ruby-ivar">@raw_source</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_sort_order" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_sort_order</span><span
            class="method-args">(order)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Allows you to set the sort order of the parts, overriding the default sort
order. Defaults to ‘text/plain’, then ‘text/enriched’, then ‘text/html’
with any other content type coming after.</p>
          
          

          
          <div class="method-source-code" id="set_sort_order-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 118</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_sort_order</span>(<span class="ruby-identifier">order</span>)
  <span class="ruby-ivar">@part_sort_order</span> = <span class="ruby-identifier">order</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-sort_parts-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sort_parts!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Allows you to sort the parts according to the default sort order, or the
sort order you set with :set_sort_order.</p>

<p>sort_parts! is also called from :encode, so there is no need for you to
call this explicitly</p>
          
          

          
          <div class="method-source-code" id="sort_parts-21-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 126</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sort_parts!</span>
  <span class="ruby-ivar">@parts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">p</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">set_sort_order</span>(<span class="ruby-ivar">@part_sort_order</span>)
    <span class="ruby-identifier">p</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">sort_parts!</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@parts</span>.<span class="ruby-identifier">sort!</span>(<span class="ruby-ivar">@part_sort_order</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-split-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">split!</span><span
            class="method-args">(boundary)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="split-21-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">split!</span>(<span class="ruby-identifier">boundary</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">boundary</span> = <span class="ruby-identifier">boundary</span>
  <span class="ruby-identifier">parts</span> = <span class="ruby-identifier">raw_source</span>.<span class="ruby-identifier">split</span>(<span class="ruby-node">/(?:\A|\r\n)--#{Regexp.escape(boundary || &quot;&quot;)}(?=(?:--)?\s*$)/</span>)
  <span class="ruby-comment"># Make the preamble equal to the preamble (if any)</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">preamble</span> = <span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>
  <span class="ruby-comment"># Make the epilogue equal to the epilogue (if any)</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">epilogue</span> = <span class="ruby-identifier">parts</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'--'</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">strip</span>
  <span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">part</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@parts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Mail</span><span class="ruby-operator">::</span><span class="ruby-constant">Part</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">part</span>) }
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_s" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="to_s-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 182</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">decoded</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-crlf_boundary" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">crlf_boundary</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="crlf_boundary-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 278</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">crlf_boundary</span>
  <span class="ruby-node">&quot;\r\n--#{boundary}\r\n&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-end_boundary" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">end_boundary</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="end_boundary-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 282</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">end_boundary</span>
  <span class="ruby-node">&quot;\r\n--#{boundary}--\r\n&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_charset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_charset</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="set_charset-source">
            <pre><span class="ruby-comment"># File lib/mail/body.rb, line 286</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_charset</span>
  <span class="ruby-identifier">only_us_ascii?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@charset</span> = <span class="ruby-string">'US-ASCII'</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@charset</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

