<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class MIME::Types - mime-types-2.3 Documentation</title>

<link href="../fonts.css" rel="stylesheet">
<link href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/navigation.js"></script>
<script src="../js/search_index.js"></script>
<script src="../js/search.js"></script>
<script src="../js/searcher.js"></script>
<script src="../js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#class-MIME::Types-label-The+Default+mime-types+Registry">The Default mime-types Registry</a>
    <li><a href="#class-MIME::Types-label-Usage">Usage</a>
  </ul>
</div>


  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">Enumerable</span>
  
  
  
    <li><span class="include">Enumerable</span>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-5B-5D">#[]</a>
    
    <li ><a href="#method-i-__types__">#__types__</a>
    
    <li ><a href="#method-i-add">#add</a>
    
    <li ><a href="#method-i-add_type">#add_type</a>
    
    <li ><a href="#method-i-add_type_variant-21">#add_type_variant!</a>
    
    <li ><a href="#method-i-cache_file">#cache_file</a>
    
    <li ><a href="#method-i-count">#count</a>
    
    <li ><a href="#method-i-each">#each</a>
    
    <li ><a href="#method-i-index_extensions-21">#index_extensions!</a>
    
    <li ><a href="#method-i-lazy_load-3F">#lazy_load?</a>
    
    <li ><a href="#method-i-load_default_mime_types">#load_default_mime_types</a>
    
    <li ><a href="#method-i-load_from_file">#load_from_file</a>
    
    <li ><a href="#method-i-match">#match</a>
    
    <li ><a href="#method-i-of">#of</a>
    
    <li ><a href="#method-i-prune_matches">#prune_matches</a>
    
    <li ><a href="#method-i-type_for">#type_for</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-MIME::Types">
  <h1 id="class-MIME::Types" class="class">
    class MIME::Types
  </h1>

  <section class="description">
    
<p><a href="Types.html">MIME::Types</a> is a registry of <a
href="../MIME.html">MIME</a> types. It is both a class (created with <a
href="Types.html#method-c-new">::new</a>) and a default registry (loaded
automatically or through interactions with <a
href="Types.html#method-i-5B-5D">#[]</a> and <a
href="Types.html#method-i-type_for">#type_for</a>).</p>

<h2 id="class-MIME::Types-label-The+Default+mime-types+Registry">The Default mime-types Registry<span><a href="#class-MIME::Types-label-The+Default+mime-types+Registry">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<p>The default mime-types registry is loaded automatically when the library is
required (<code>require 'mime/types'</code>), but it may be lazily loaded
(loaded on first use) with the use of the environment variable
<code>RUBY_MIME_TYPES_LAZY_LOAD</code> having any value other than
<code>false</code>. The initial startup is about 14× faster (~10 ms vs ~140
ms), but the registry will be loaded at some point in the future.</p>

<p>The default mime-types registry can also be loaded from a Marshal cache
file specific to the version of <a href="Types.html">MIME::Types</a> being
loaded. This will be handled automatically with the use of a file referred
to in the environment variable <code>RUBY_MIME_TYPES_CACHE</code>. <a
href="Types.html">MIME::Types</a> will attempt to load the registry from
this cache file (MIME::Type::Cache.load); if it cannot be loaded (because
the file does not exist, there is an error, or the data is for a different
version of mime-types), the default registry will be loaded from the normal
JSON version and then the cache file will be <strong>written</strong> to
the location indicated by <code>RUBY_MIME_TYPES_CACHE</code>. <a
href="Types/Cache.html">Cache</a> file loads just over 4½× faster (~30 ms
vs ~140 ms). loads.</p>

<p>Notes:</p>
<ul><li>
<p>The loading of the default registry is <strong>not</strong> atomic; when
using a multi-threaded environment, it is recommended that lazy loading is
not used and mime-types is loaded as early as possible.</p>
</li><li>
<p><a href="Types/Cache.html">Cache</a> files should be specified per
application in a multiprocess environment and should be initialized during
deployment or before forking to minimize the chance that the multiple
processes will be trying to write to the same cache file at the same time,
or that two applications that are on different versions of mime-types would
be thrashing the cache.</p>
</li><li>
<p>Unless cache files are preinitialized, the application using the mime-types
cache file must have read/write permission to the cache file.</p>
</li></ul>

<h2 id="class-MIME::Types-label-Usage">Usage<span><a href="#class-MIME::Types-label-Usage">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'mime/types'</span>

<span class="ruby-identifier">plaintext</span> = <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>[<span class="ruby-string">'text/plain'</span>]
<span class="ruby-identifier">print</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">media_type</span>           <span class="ruby-comment"># =&gt; 'text'</span>
<span class="ruby-identifier">print</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">sub_type</span>             <span class="ruby-comment"># =&gt; 'plain'</span>

<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>)  <span class="ruby-comment"># =&gt; 'asc txt c cc h hh cpp'</span>

<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">encoding</span>              <span class="ruby-comment"># =&gt; 8bit</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">binary?</span>               <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">ascii?</span>                <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">obsolete?</span>             <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">registered?</span>           <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span> <span class="ruby-operator">==</span> <span class="ruby-string">'text/plain'</span>       <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>.<span class="ruby-identifier">simplified</span>(<span class="ruby-string">'x-appl/x-zip'</span>) <span class="ruby-comment"># =&gt; 'appl/zip'</span>
</pre>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="Cache">Cache
        
        <dd><p>Caching of <a href="Types.html">MIME::Types</a> registries is advisable if
you will be loading the default registry relatively frequently. With the
class methods on <a href="Types/Cache.html">MIME::Types::Cache</a>, any <a
href="Types.html">MIME::Types</a> registry can be marshaled quickly and
easily.</p>

<p>The cache is invalidated on a per-version basis; a cache file for version
2.0 will not be reused with version 2.0.1.</p>
        
      
        <dt id="VERSION">VERSION
        
        <dd><p>The release version of Ruby <a href="Types.html">MIME::Types</a></p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-data_version" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">data_version</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The data version.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new <a href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 71</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@type_variants</span>    = <span class="ruby-constant">Container</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@extension_index</span>  = <span class="ruby-constant">Container</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@data_version</span>     = <span class="ruby-constant">VERSION</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">freeze</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(type_id, flags = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a list of <a href="Type.html">MIME::Type</a> objects, which may be
empty. The optional flag parameters are <code>:complete</code> (finds only
complete <a href="Type.html">MIME::Type</a> objects) and
<code>:registered</code> (finds only <a href="Types.html">MIME::Types</a>
that are registered). It is possible for multiple matches to be returned
for either type (in the example below, ‘text/plain’ returns two values –
one for the general case, and one for VMS systems).</p>

<pre class="ruby"><span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\nMIME::Types['text/plain']&quot;</span>
<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>[<span class="ruby-string">'text/plain'</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;, &quot;</span>) }

<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\nMIME::Types[/^image/, complete: true]&quot;</span>
<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>[<span class="ruby-regexp">/^image/</span>, :<span class="ruby-identifier">complete</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;, &quot;</span>)
<span class="ruby-keyword">end</span>
</pre>

<p>If multiple type definitions are returned, returns them sorted as follows:</p>

<pre>1. Complete definitions sort before incomplete ones;
2. IANA-registered definitions sort before LTSW-recorded
   definitions.
3. Generic definitions sort before platform-specific ones;
4. Current definitions sort before obsolete ones;
5. Obsolete definitions with use-instead clauses sort before those
   without;
6. Obsolete definitions use-instead clauses are compared.
7. Sort on name.</pre>

<p>An additional flag of :platform (finds only <a
href="Types.html">MIME::Types</a> for the current platform) is currently
supported but deprecated.</p>
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">flags</span> = {})
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-value">:platform</span>]
    <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>, <span class="ruby-string">&quot;using the :platform flag&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">matches</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">type_id</span>
            <span class="ruby-keyword">when</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>
              <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">type_id</span>.<span class="ruby-identifier">simplified</span>]
            <span class="ruby-keyword">when</span> <span class="ruby-constant">Regexp</span>
              <span class="ruby-identifier">match</span>(<span class="ruby-identifier">type_id</span>)
            <span class="ruby-keyword">else</span>
              <span class="ruby-ivar">@type_variants</span>[<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>.<span class="ruby-identifier">simplified</span>(<span class="ruby-identifier">type_id</span>)]
            <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">prune_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">flags</span>).<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">priority_compare</span>(<span class="ruby-identifier">b</span>) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add</span><span
            class="method-args">(*types)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add one or more <a href="Type.html">MIME::Type</a> objects to the set of
known types. If the type is already known, a warning will be displayed.</p>

<p>The last parameter may be the value <code>:silent</code> or
<code>true</code> which will suppress duplicate <a
href="../MIME.html">MIME</a> type warnings.</p>
          
          

          
          <div class="method-source-code" id="add-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 185</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">types</span>)
  <span class="ruby-identifier">quiet</span> = ((<span class="ruby-identifier">types</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-value">:silent</span>) <span class="ruby-keyword">or</span> (<span class="ruby-identifier">types</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>))

  <span class="ruby-identifier">types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">mime_type</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">mime_type</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">true</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-constant">Symbol</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>
      <span class="ruby-identifier">variants</span> = <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-value">:@type_variants</span>)
      <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">flatten</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">add_type</span>(<span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_type</span><span
            class="method-args">(mime_type, quiet = false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a single <a href="Type.html">MIME::Type</a> object to the set of known
types. If the type is already known, a warning will be displayed. The
<code>quiet</code> parameter may be a truthy value to suppress that
warning.</p>
          
          

          
          <div class="method-source-code" id="add_type-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 206</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_type</span>(<span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">quiet</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">mime_type</span>)
    <span class="ruby-identifier">warn</span>(<span class="ruby-string">&quot;Type %s is already registered as a variant of %s.&quot;</span> <span class="ruby-operator">%</span> [
      <span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span> ])
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">add_type_variant!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-identifier">index_extensions!</span>(<span class="ruby-identifier">mime_type</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-cache_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cache_file</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the currently defined cache file, if any.</p>
          
          

          
          <div class="method-source-code" id="cache_file-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_file</span>
  <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>)
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">'RUBY_MIME_TYPES_CACHE'</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-count" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the number of known type variants.</p>
          
          

          
          <div class="method-source-code" id="count-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 93</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">reduce</span>(<span class="ruby-value">0</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">size</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each</span><span
            class="method-args">() { |t| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates through the type variants.</p>
          
          

          
          <div class="method-source-code" id="each-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">tv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tv</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">t</span> } }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-load_from_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_from_file</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Load <a href="Types.html">MIME::Types</a> from a v1 file registry.</p>

<p>This method has been deprecated.</p>
          
          

          
          <div class="method-source-code" id="load_from_file-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 222</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_from_file</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>)
  <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Loader</span>.<span class="ruby-identifier">load_from_v1</span>(<span class="ruby-identifier">filename</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-of" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">of</span><span
            class="method-args">(filename, platform = false)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Types.html#method-i-type_for">type_for</a>
        </div>
        
      </div>

    
      <div id="method-i-type_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">type_for</span><span
            class="method-args">(filename, platform = false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the list of <a href="Types.html">MIME::Types</a> which belongs to
the file based on its filename extension. If there is no extension, the
filename will be used as the matching criteria on its own.</p>

<p>This will always return a merged, flatten, priority sorted, unique array.</p>

<pre class="ruby"><span class="ruby-identifier">puts</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>.<span class="ruby-identifier">type_for</span>(<span class="ruby-string">'citydesk.xml'</span>)
  =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">application</span><span class="ruby-operator">/</span><span class="ruby-identifier">xml</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">/</span><span class="ruby-identifier">xml</span>]
<span class="ruby-identifier">puts</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>.<span class="ruby-identifier">type_for</span>(<span class="ruby-string">'citydesk.gif'</span>)
  =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">image</span><span class="ruby-operator">/</span><span class="ruby-identifier">gif</span>]
<span class="ruby-identifier">puts</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>.<span class="ruby-identifier">type_for</span>(<span class="ruby-node">%w(citydesk.xml citydesk.gif)</span>)
  =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">application</span><span class="ruby-operator">/</span><span class="ruby-identifier">xml</span>, <span class="ruby-identifier">image</span><span class="ruby-operator">/</span><span class="ruby-identifier">gif</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">/</span><span class="ruby-identifier">xml</span>]
</pre>

<p>If <code>platform</code> is <code>true</code>, then only file types that
are specific to the current platform will be returned. This parameter has
been deprecated.</p>
          
          

          
          <div class="method-source-code" id="type_for-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">platform</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">types</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">flat_map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">fn</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@extension_index</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">fn</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">downcase</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/.*\./o</span>, <span class="ruby-string">''</span>)]
  }.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">priority_compare</span>(<span class="ruby-identifier">b</span>) }.<span class="ruby-identifier">uniq</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">platform</span>
    <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>,
                    <span class="ruby-string">&quot;using the platform parameter&quot;</span>)
    <span class="ruby-identifier">types</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:platform?</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">types</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Types.html#method-i-of">of</a>
        </div>
        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-__types__" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">__types__</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="__types__-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 272</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">__types__</span>
  (<span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@__types__</span>) <span class="ruby-keyword">and</span> <span class="ruby-ivar">@__types__</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">load_default_mime_types</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_type_variant-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_type_variant!</span><span
            class="method-args">(mime_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="add_type_variant-21-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 287</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_type_variant!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mime_type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-index_extensions-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index_extensions!</span><span
            class="method-args">(mime_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="index_extensions-21-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index_extensions!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@extension_index</span>[<span class="ruby-identifier">ext</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mime_type</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-lazy_load-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">lazy_load?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="lazy_load-3F-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 268</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">lazy_load?</span>
  (<span class="ruby-identifier">lazy</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">'RUBY_MIME_TYPES_LAZY_LOAD'</span>]) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">lazy</span> <span class="ruby-operator">!=</span> <span class="ruby-string">'false'</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-load_default_mime_types" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_default_mime_types</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="load_default_mime_types-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 276</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_default_mime_types</span>
  <span class="ruby-ivar">@__types__</span> = <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span>.<span class="ruby-identifier">load</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@__types__</span>
    <span class="ruby-ivar">@__types__</span> = <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Loader</span>.<span class="ruby-identifier">load</span>
    <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span>.<span class="ruby-identifier">save</span>(<span class="ruby-ivar">@__types__</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@__types__</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-match" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">match</span><span
            class="method-args">(pattern)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="match-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 302</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">pattern</span>)
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">pattern</span> }.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">flatten</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-prune_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">prune_matches</span><span
            class="method-args">(matches, flags)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="prune_matches-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 295</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">prune_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">flags</span>)
  <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">complete?</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-value">:complete</span>]
  <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">platform?</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-value">:platform</span>]
  <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">registered?</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-value">:registered</span>]
  <span class="ruby-identifier">matches</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

